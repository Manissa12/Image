import pandas as pd

# À adapter avec les vrais noms / chemins de tes fichiers
fichier1 = "resultats_controls_Actfin_06_2025.xlsx"
fichier2 = "resultats_controls_Actfin_09_2025.xlsx"
fichier_sortie = "resultat_fusion.xlsx"

# On charge la liste des onglets des deux fichiers
xls1 = pd.ExcelFile(fichier1)
xls2 = pd.ExcelFile(fichier2)

# On garde les onglets communs aux deux fichiers
onglets_communs = [nom for nom in xls1.sheet_names if nom in xls2.sheet_names]

print("Onglets communs trouvés :", onglets_communs)

# On crée le nouveau fichier Excel
with pd.ExcelWriter(fichier_sortie, engine="openpyxl") as writer:
    for onglet in onglets_communs:
        print(f"Traitement de l’onglet : {onglet}")

        # Lecture du contenu en conservant "NA", "N1", etc. comme du texte
        df1 = pd.read_excel(
            fichier1,
            sheet_name=onglet,
            keep_default_na=False   # empêche NA/N1 d'être vus comme des NaN
        )

        df2 = pd.read_excel(
            fichier2,
            sheet_name=onglet,
            keep_default_na=False
        )

        # Concaténation : contenu fichier1 puis fichier2
        df_concat = pd.concat([df1, df2], ignore_index=True)

        # Écriture dans le fichier de sortie
        df_concat.to_excel(writer, sheet_name=onglet, index=False)

print(f"Fusion terminée ! Fichier créé : {fichier_sortie}")
