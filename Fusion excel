import pandas as pd

# üîÅ √Ä adapter avec les vrais noms / chemins de tes fichiers
fichier1 = "fichier1.xlsx"
fichier2 = "fichier2.xlsx"
fichier_sortie = "resultat_fusion.xlsx"

# On charge la liste des onglets des deux fichiers
xls1 = pd.ExcelFile(fichier1)
xls2 = pd.ExcelFile(fichier2)

# On ne garde que les onglets communs aux deux fichiers
onglets_communs = [nom for nom in xls1.sheet_names if nom in xls2.sheet_names]

print("Onglets communs trouv√©s :", onglets_communs)

# On cr√©e le nouveau fichier Excel
with pd.ExcelWriter(fichier_sortie, engine="openpyxl") as writer:
    for onglet in onglets_communs:
        print(f"Traitement de l‚Äôonglet : {onglet}")

        # Lecture de l‚Äôonglet dans chaque fichier

        df1 = pd.read_excel(fichier1, sheet_name=onglet)
        df2 = pd.read_excel(fichier2, sheet_name=onglet)

        # Concat√©nation : contenu du fichier1 puis du fichier2
        df_concat = pd.concat([df1, df2], ignore_index=True)

        # √âcriture dans le fichier de sortie, m√™me nom d‚Äôonglet
        df_concat.to_excel(writer, sheet_name=onglet, index=False)

print(f"Fusion termin√©e ! Fichier cr√©√© : {fichier_sortie}")
